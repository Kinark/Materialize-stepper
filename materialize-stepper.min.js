/* Materializecss Stepper - By Kinark 2016
// https://github.com/Kinark/Materialize-stepper
// JS.min v2.1.3
*/
var validation=$.isFunction($.fn.valid)?1:0;$.fn.isValid=function(){return!validation||this.valid()},validation&&($.validator.setDefaults({errorClass:"invalid",validClass:"valid",errorPlacement:function(e,t){t.is(":radio")||t.is(":checkbox")?e.insertBefore($(t).parent()):e.insertAfter(t)},success:function(e){$(e).closest("li").find("label.invalid:not(:empty)").length||$(e).closest("li").removeClass("wrong")}}),$(".stepper.parallel").length&&$.validator.setDefaults({ignore:""})),$.fn.getActiveStep=function(){var e=this.find(".step.active");return $(this.children(".step:visible")).index($(e))+1},$.fn.activateStep=function(e){if(!$(this).hasClass("step")){var t=$(this).closest("ul.stepper");t.find(">li").removeAttr("data-last"),window.innerWidth<993||!t.hasClass("horizontal")?$(this).addClass("step").stop().slideDown(400,function(){$(this).css({height:"auto","margin-bottom":"",display:"inherit"}),e&&e(),t.find(">li.step").last().attr("data-last","true")}):$(this).addClass("step").stop().css({width:"0%",display:"inherit"}).animate({width:"100%"},400,function(){$(this).css({height:"auto","margin-bottom":"",display:"inherit"}),e&&e(),t.find(">li.step").last().attr("data-last","true")})}},$.fn.deactivateStep=function(e){if($(this).hasClass("step")){var t=$(this).closest("ul.stepper");t.find(">li").removeAttr("data-last"),window.innerWidth<993||!t.hasClass("horizontal")?$(this).stop().css({transition:"none","-webkit-transition":"margin-bottom none"}).slideUp(400,function(){$(this).removeClass("step").css({height:"auto","margin-bottom":"",transition:"margin-bottom .4s","-webkit-transition":"margin-bottom .4s"}),e&&e(),t.find(">li").removeAttr("data-last"),t.find(">li.step").last().attr("data-last","true")}):$(this).stop().animate({width:"0%"},400,function(){$(this).removeClass("step").hide().css({height:"auto","margin-bottom":"",display:"none",width:""}),e&&e(),t.find(">li.step").last().attr("data-last","true")})}},$.fn.showError=function(e){if(validation){var t=this.attr("name"),i=this.closest("form"),s={};s[t]=e,i.validate().showErrors(s),this.closest("li").addClass("wrong")}else this.removeClass("valid").addClass("invalid"),this.next().attr("data-error",e)},$.fn.activateFeedback=function(){this.find(".step.active:not(.feedbacking)").addClass("feedbacking").find(".step-content").prepend('<div class="wait-feedback"> <div class="preloader-wrapper active"> <div class="spinner-layer spinner-blue"> <div class="circle-clipper left"> <div class="circle"></div></div><div class="gap-patch"> <div class="circle"></div></div><div class="circle-clipper right"> <div class="circle"></div></div></div><div class="spinner-layer spinner-red"> <div class="circle-clipper left"> <div class="circle"></div></div><div class="gap-patch"> <div class="circle"></div></div><div class="circle-clipper right"> <div class="circle"></div></div></div><div class="spinner-layer spinner-yellow"> <div class="circle-clipper left"> <div class="circle"></div></div><div class="gap-patch"> <div class="circle"></div></div><div class="circle-clipper right"> <div class="circle"></div></div></div><div class="spinner-layer spinner-green"> <div class="circle-clipper left"> <div class="circle"></div></div><div class="gap-patch"> <div class="circle"></div></div><div class="circle-clipper right"> <div class="circle"></div></div></div></div></div>')},$.fn.destroyFeedback=function(){var e=this.find(".step.active.feedbacking");return e&&(e.removeClass("feedbacking"),e.find(".wait-feedback").remove()),!0},$.fn.resetStepper=function(e){e||(e=1);var t=$(this).closest("form");return $(t)[0].reset(),Materialize.updateTextFields(),validation&&(t.validate().resetForm(),$(this).find("li.step").removeClass("wrong")),$(this).openStep(e)},$.fn.submitStepper=function(e){var t=this.closest("form");t.isValid()&&t.submit()},$.fn.nextStep=function(e,t,i){var s=$(this).data("settings"),a=this.closest("form"),n=this.find(".step.active"),l=$(this.children(".step:visible")).index($(n))+2,d=n.find(".next-step").length>1?i?$(i.target).data("feedback"):void 0:n.find(".next-step").data("feedback");return s.parallel&&$(n).validateStep()||!s.parallel&&a.isValid()?d&&t?(s.showFeedbackLoader&&this.activateFeedback(),window[d].call()):(n.removeClass("wrong").addClass("done"),this.openStep(l,e),this.trigger("nextstep")):n.removeClass("done").addClass("wrong")},$.fn.prevStep=function(e){var t=this.find(".step.active");if(!t.hasClass("feedbacking")){var i=$(this.children(".step:visible")).index($(t));return t.removeClass("wrong"),this.openStep(i,e),this.trigger("prevstep")}},$.fn.openStep=function(e,t){var i=$(this).closest("ul.stepper").data("settings"),s=this,a=e-1;if(!(e=this.find(".step:visible:eq("+a+")")).hasClass("active")){var n=this.find(".step.active"),l=$(this.children(".step:visible")).index($(n)),d=a>l?1:0;n.hasClass("feedbacking")&&s.destroyFeedback(),n.closeAction(d),e.openAction(d,function(){i.autoFocusInput&&e.find("input:enabled:visible:first").focus(),s.trigger("stepchange").trigger("step"+(a+1)),e.data("event")&&s.trigger(e.data("event")),t&&t(),s.closest("ul").hasClass("horizontal")&&(newHeight=0,padding=140,$(".stepper.horizontal").find(".step.active").find(".step-content > div").each(function(e,t){console.log(t),newHeight+=parseInt($(t).css("height"))}),newHeight+=padding,$(".stepper.horizontal").animate({height:newHeight},300))})}},$.fn.closeAction=function(e,t){var i=this.removeClass("active").find(".step-content");window.innerWidth<993||!this.closest("ul").hasClass("horizontal")?i.stop().slideUp(300,"easeOutQuad",t):1==e?i.animate({left:"-100%"},function(){i.css({display:"none",left:"0%"},t)}):i.animate({left:"100%"},function(){i.css({display:"none",left:"0%"},t)})},$.fn.openAction=function(e,t){var i=this.removeClass("done").addClass("active").find(".step-content");window.innerWidth<993||!this.closest("ul").hasClass("horizontal")?(newHeight=0,padding=200,$(".stepper.horizontal").find(".step.active").find(".step-content > div").each(function(){console.log(newHeight),newHeight+=parseInt($(this).css("height"))}),newHeight+=padding,$(".stepper.horizontal").animate({height:newHeight},300),i.slideDown(300,"easeOutQuad",t)):1==e?i.css({left:"100%",display:"block"}).animate({left:"0%"},t):i.css({left:"-100%",display:"block"}).animate({left:"0%"},t)},$.fn.activateStepper=function(e){var t=$.extend({linearStepsNavigation:!0,autoFocusInput:!0,showFeedbackLoader:!0,autoFormCreation:!0,parallel:!1},e);$(document).on("click",function(e){$(e.target).parents(".stepper").length||$(".stepper.focused").removeClass("focused")}),$(this).each(function(){var e=$(this);if(!e.parents("form").length&&t.autoFormCreation){var i=e.data("method"),s=e.data("action");i=i||"GET";s=s||"?",e.wrap('<form action="'+s+'" method="'+i+'"></form>')}e.data("settings",{linearStepsNavigation:t.linearStepsNavigation,autoFocusInput:t.autoFocusInput,showFeedbackLoader:t.showFeedbackLoader,parallel:e.hasClass("parallel")}),e.find("li.step.active").openAction(1),e.find(">li").removeAttr("data-last"),e.find(">li.step").last().attr("data-last","true"),e.on("click",".step:not(.active)",function(){var i=$(e.children(".step:visible")).index($(this));if(e.data("settings").parallel&&validation)$(this).addClass("temp-active"),e.validatePreviousSteps(),e.openStep(i+1),$(this).removeClass("temp-active");else if(e.hasClass("linear")){if(t.linearStepsNavigation){var s=e.find(".step.active");$(e.children(".step:visible")).index($(s))+1==i?e.nextStep(void 0,!0,void 0):$(e.children(".step:visible")).index($(s))-1==i&&e.prevStep(void 0)}}else e.openStep(i+1)}).on("click",".next-step",function(t){t.preventDefault(),e.nextStep(void 0,!0,t)}).on("click",".previous-step",function(t){t.preventDefault(),e.prevStep(void 0)}).on("click","button:submit:not(.next-step, .previous-step)",function(t){t.preventDefault(),feedback=t?$(t.target).data("feedback"):void 0;var i=e.closest("form");if(i.isValid()){if(feedback)return stepper.activateFeedback(),window[feedback].call();i.submit()}}).on("click",function(){$(".stepper.focused").removeClass("focused"),$(this).addClass("focused")})})},$.fn.getStep=function(e){$(this).closest("ul.stepper").data("settings");var t=e-1;return e=this.find(".step:visible:eq("+t+")")},$.fn.validatePreviousSteps=function(){var e=$(this).find(".step.temp-active"),t=$(this.children(".step")).index($(e));$(this.children(".step")).each(function(e){e>=t?$(this).removeClass("wrong done"):$(this).validateStep()})},$.fn.validateStep=function(){this.closest("ul.stepper"),this.closest("form");var e=$(this),t=e.find(".next-step").data("validator");return this.validateStepInput()?t?window[t].call()?(e.removeClass("wrong").addClass("done"),!0):(e.removeClass("done").addClass("wrong"),!1):(e.removeClass("wrong").addClass("done"),!0):(e.removeClass("done").addClass("wrong"),!1)},$.fn.validateStepInput=function(){var e=!0;return validation&&$(this).find("input.validate").each(function(){if(!$(this).valid())return e=!1,!1}),e};
